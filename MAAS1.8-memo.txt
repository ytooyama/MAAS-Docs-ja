MAAS 1.8をインストールした時の記録
インストール日: 12/04/2015

プロジェクト名が変わった模様
https://launchpad.net/~maas/+archive/ubuntu/stable
前のプロジェクトサイト
https://launchpad.net/~maas-maintainers/+archive/ubuntu/stable

■MAASのall-in-oneインストール

add-apt-repositoryに必要なパッケージを入れる。
$ sudo apt-get install software-properties-common python-software-properties

リポジトリーを追加
$ sudo add-apt-repository ppa:maas/stable

ただし12/4/2015現在、MAAS 1.8.3はまともに動かない模様
https://launchpad.net/maas/+milestone/1.8.3

なので古いリポジトリーを追加して1.8.2をインストールする
$ sudo add-apt-repository  ppa:maas-maintainers/stable

リポジトリー追加後にリポジトリー情報の更新
$ sudo apt-get update

追加したリポジトリーが候補としてあがるか確認
$ apt-cache policy maas maas-dhcp maas-dns

バージョン1.8.xが見えていることを確認。Ubuntuはバージョン指定をしない限り、最新版をインストールします。

この後のインストール手順はこれに従えば良い。
http://maas.ubuntu.com/docs1.8/install.html

ESXiのVMを制御したい場合(MAAS 1.8より)は以下のパッケージを入れる
$ sudo apt-get install python-pyvmomi


■インストール後の設定変更

(1)User preferencesの編集

・SSH鍵を登録
デプロイノードにSSHアクセスできるようにするために必要。

(2)Cluster Interfaceの編集

・Management
If you enable DHCP management, you will need to install the 'maas-dhcp' package on this cluster controller. Similarly, you will need to install the 'maas-dns' package on this region controller to be able to enable DNS management.

・Router IP
IP of this network's router given to DHCP clients
DHCP dynamic IP range low value
Lowest IP number of the range for dynamic IPs, used for enlistment, commissioning and unknown devices.

・DHCP dynamic IP range high value
Highest IP number of the range for dynamic IPs, used for enlistment, commissioning and unknown devices.

・Static IP range low value
Lowest IP number of the range for IPs given to allocated nodes, must be in same network as dynamic range.

・Static IP range high value
Highest IP number of the range for IPs given to allocated nodes, must be in same network as dynamic range.

(3)Settingsの設定変更

Ubuntu
Main archive (required)
http://archive.ubuntu.com/ubuntu
↓
http://ja.archive.ubuntu.com/ubuntu

Network Configuration
Upstream DNS used to resolve domains not managed by this MAAS (space-separated IP addresses)
→上流のDNSサーバーを指定。なければパブリックDNSなどを指定。

Enable DNSSEC validation of upstream zones
Only used when MAAS is running its own DNS server. This value is used as the value of 'dnssec_validation' in the DNS server config.
→DNSSEC非対応のDNSサーバーを指定する場合はここをNoにする

(4)Boot Images
MAASブートイメージのSync URLを設定
ミラーを作ってローカルサーバーを指定したほうがいい

ミラーの作り方とイメージインポート
https://maas.ubuntu.com/docs/sstreams-mirror.html